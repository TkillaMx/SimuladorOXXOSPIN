<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Crédito Hipotecario</title>
</head>
<body>
    <h2>Simulador de Crédito Hipotecario</h2>
    <form id="mortgageForm">
        <label for="principalAmount">Monto del crédito:</label>
        <input type="number" id="principalAmount" required><br><br>
        
        <label for="interestRate">Tasa de interés anual (%):</label>
        <input type="number" step="0.01" id="interestRate" required><br><br>
        
        <label for="loanTerm">Plazo del crédito (años):</label>
        <input type="number" id="loanTerm" required><br><br>

        <label for="interestType">Tipo de interés:</label>
        <select id="interestType">
            <option value="simple">Simple</option>
            <option value="compuesto">Compuesto</option>
        </select><br><br>

        <label for="compoundingOption">Opción de capitalización (solo para interés compuesto):</label>
        <select id="compoundingOption">
            <option value="2">Semestral</option>
            <option value="3">Cuatrimestral</option>
            <option value="4">Trimestral</option>
        </select><br><br>

        <button type="button" onclick="calculateMortgage()">Calcular</button>
    </form>

    <h3>Resultado</h3>
    <p id="result"></p>

    <h3>Historial de Balance</h3>
    <table id="balanceTable" border="1">
        <thead>
            <tr>
                <th>Periodo</th>
                <th>Balance</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>
        function calculateMortgage() {
            const principalAmount = parseFloat(document.getElementById('principalAmount').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value) / 100;
            const loanTerm = parseInt(document.getElementById('loanTerm').value);
            const interestType = document.getElementById('interestType').value;
            const n = parseInt(document.getElementById('compoundingOption').value);

            let historial = [];
            let interesGanado = 0;
            let balanceTotal = 0;

            if (interestType === 'compuesto') {
                [historial, interesGanado, balanceTotal] = calcularInteresCompuesto(principalAmount, interestRate, loanTerm, n);
            } else if (interestType === 'simple') {
                [historial, interesGanado, balanceTotal] = calcularInteresSimple(principalAmount, interestRate, loanTerm);
            }

            document.getElementById('result').textContent = 
                `Interés total ganado: $${interesGanado.toFixed(2)}\nMonto total al final del periodo: $${balanceTotal.toFixed(2)}`;
            
            const balanceTableBody = document.getElementById('balanceTable').getElementsByTagName('tbody')[0];
            balanceTableBody.innerHTML = '';
            historial.forEach(([periodo, balance]) => {
                const row = balanceTableBody.insertRow();
                const cellPeriodo = row.insertCell(0);
                const cellBalance = row.insertCell(1);
                cellPeriodo.textContent = periodo;
                cellBalance.textContent = balance.toFixed(2);
            });
        }

        function calcularInteresCompuesto(principal, tasa, tiempo, n) {
            let balance = principal;
            const historial = [];

            for (let periodo = 1; periodo <= n * tiempo; periodo++) {
                balance *= (1 + tasa / n);
                historial.push([periodo, balance]);
            }

            const interesGanado = balance - principal;
            return [historial, interesGanado, balance];
        }

        function calcularInteresSimple(principal, tasa, tiempo) {
            const interesGanado = principal * tasa * tiempo;
            const balanceTotal = principal + interesGanado;
            const historial = [];

            for (let año = 1; año <= tiempo; año++) {
                historial.push([año, principal + principal * tasa * año]);
            }

            return [historial, interesGanado, balanceTotal];
        }
    </script>
</body>
</html>
